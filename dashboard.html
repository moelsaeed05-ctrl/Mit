<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>MIT STORE - Admin Dashboard</title>
  <style>
    body{
      font-family: Arial;
      background:#111;
      color:white;
      padding:20px;
    }

    h2{
      text-align:center;
      margin-bottom:20px;
    }

    input, textarea, select{
      width:100%;
      padding:10px;
      margin:6px 0;
      border-radius:6px;
      border:none;
      outline:none;
    }

    button{
      padding:10px 15px;
      border:none;
      border-radius:6px;
      cursor:pointer;
      margin-top:8px;
    }

    .add-btn{
      background:#28a745;
      color:white;
    }

    .delete-btn{
      background:#dc3545;
      color:white;
    }

    .card{
      background:#222;
      padding:15px;
      margin:15px 0;
      border-radius:10px;
    }

    img{
      width:120px;
      margin-top:10px;
      border-radius:6px;
    }

  </style>
</head>
<body>

<h2>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>

<input type="text" id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
<input type="number" id="price" placeholder="Ø§Ù„Ø³Ø¹Ø±">
<textarea id="desc" placeholder="Ø§Ù„ÙˆØµÙ"></textarea>

<select id="size">
  <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù‚Ø§Ø³</option>
  <option>S</option>
  <option>M</option>
  <option>L</option>
  <option>XL</option>
</select>

<select id="category">
  <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø©</option>
  <option value="HOODIES">HOODIES</option>
  <option value="PANTS">PANTS</option>
  <option value="ACCESSORIES">ACCESSORIES</option>
</select>

<input type="file" id="image">

<button class="add-btn" onclick="addProduct()">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</button>

<h3>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:</h3>
<div id="products"></div>


<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc }
from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

/* ğŸ”¥ firebaseConfig Ø¨ØªØ§Ø¹Ùƒ */
const firebaseConfig = {
  apiKey: "AIzaSyA1X_1BlviMDKKUGnA8yfG6NCrfS65h524",
  authDomain: "mit-store-bd580.firebaseapp.com",
  projectId: "mit-store-bd580",
  storageBucket: "mit-store-bd580.firebasestorage.app",
  messagingSenderId: "382577223227",
  appId: "1:382577223227:web:71a4945a81cfbb9e06de1e"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* ğŸ” Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ø¯Ù…Ù† */
if(localStorage.getItem("adminLoggedIn") !== "true"){
  window.location.href = "login.html";
}

/* â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ */
window.addProduct = async function(){

  const name = document.getElementById("name").value;
  const price = document.getElementById("price").value;
  const desc = document.getElementById("desc").value;
  const size = document.getElementById("size").value;
  const category = document.getElementById("category").value;
  const file = document.getElementById("image").files[0];

  if(!name || !price || !category || !file){
    alert("Ø§Ù…Ù„Ø£ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
    return;
  }

  const reader = new FileReader();

  reader.onload = async function(e){

    await addDoc(collection(db,"products"),{
      name:name,
      price:price,
      desc:desc,
      size:size,
      category:category,
      image:e.target.result,
      createdAt: Date.now()
    });

    clearForm();
    displayProducts();
  };

  reader.readAsDataURL(file);
}

/* ğŸ—‘ Ø­Ø°Ù Ù…Ù†ØªØ¬ */
window.deleteProduct = async function(id){
  await deleteDoc(doc(db,"products",id));
  displayProducts();
}

/* ğŸ“¦ Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
async function displayProducts(){

  const container = document.getElementById("products");
  container.innerHTML = "";

  const querySnapshot = await getDocs(collection(db,"products"));

  querySnapshot.forEach((docSnap)=>{
    const p = docSnap.data();

    container.innerHTML += `
      <div class="card">
        <h4>${p.name}</h4>
        <p>Ø§Ù„ÙØ¦Ø©: ${p.category}</p>
        <p>Ø§Ù„Ø³Ø¹Ø±: ${p.price} Ø¬Ù†ÙŠÙ‡</p>
        ${p.image ? `<img src="${p.image}">` : ""}
        <br>
        <button class="delete-btn" onclick="deleteProduct('${docSnap.id}')">Ø­Ø°Ù</button>
      </div>
    `;
  });

}

/* ğŸ§¹ ØªÙ†Ø¸ÙŠÙ Ø§Ù„ÙÙˆØ±Ù… */
function clearForm(){
  document.getElementById("name").value="";
  document.getElementById("price").value="";
  document.getElementById("desc").value="";
  document.getElementById("size").value="";
  document.getElementById("category").value="";
  document.getElementById("image").value="";
}

displayProducts();

</script>

</body>
</html>
