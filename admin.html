<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MIT Admin</title>

<style>

body{
margin:0;
background:black;
color:white;
font-family:Arial;
}

.container{
display:flex;
height:100vh;
}

/* Sidebar */

.sidebar{
width:250px;
background:#0f0f0f;
padding:20px;
display:flex;
flex-direction:column;
gap:15px;
}

.sidebar button{
padding:12px;
border:none;
border-radius:8px;
cursor:pointer;
background:#ffd700;
font-weight:bold;
}

/* Content */

.content{
flex:1;
padding:30px;
}

input,select{
width:100%;
padding:10px;
margin-top:8px;
border-radius:8px;
border:none;
}

.product-box{
background:#111;
padding:15px;
border-radius:12px;
margin-top:20px;
display:flex;
gap:15px;
align-items:center;
}

.product-box img{
width:70px;
height:70px;
object-fit:cover;
border-radius:10px;
}

.delete-btn{
margin-left:auto;
background:red;
color:white;
border:none;
padding:8px 12px;
border-radius:8px;
cursor:pointer;
}

</style>
</head>

<body>

<div class="container">

<div class="sidebar">
<h3>Admin Panel</h3>

<button onclick="showAdd()">âž• Add Product</button>
<button onclick="loadProducts()">ðŸ“¦ Products</button>
<button onclick="logout()">Logout</button>

</div>

<div class="content" id="content"></div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signOut, onAuthStateChanged }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

import { getFirestore,
collection,
addDoc,
getDocs,
deleteDoc,
doc }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

import { getStorage,
ref,
uploadBytes,
getDownloadURL }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

/* Config */

const firebaseConfig={
apiKey:"AIzaSyA1X_1BlviMDKKUGnA8yfG6NCrfS65h524",
authDomain:"mit-store-bd580.firebaseapp.com",
projectId:"mit-store-bd580",
storageBucket:"mit-store-bd580.appspot.com",
messagingSenderId:"382577223227",
appId:"1:382577223227:web:113177bef81c5afb06de1e"
};

const app=initializeApp(firebaseConfig);

const auth=getAuth(app);
const db=getFirestore(app);
const storage=getStorage(app);

/* Admin Email */

const ADMIN_EMAIL="admin@gmail.com";

/* Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø© */

onAuthStateChanged(auth,(user)=>{
if(!user || user.email!==ADMIN_EMAIL){
location.href="index.html";
}
});

/* ===== Add Product UI ===== */

window.showAdd=()=>{
content.innerHTML=`
<h2>Add Product</h2>

<select id="category">
<option>HOODIES</option>
<option>PANTS</option>
<option>ACCESSORIES</option>
</select>

<input id="name" placeholder="Product Name">
<input id="price" placeholder="Price">

<input type="file" id="imageFile">

<button onclick="addProduct()">Save Product</button>
`;
};

/* ===== Upload Product ===== */

window.addProduct=async()=>{

const file=imageFile.files[0];

if(!file){
alert("Select Image");
return;
}

const storageRef=ref(storage,"products/"+Date.now());

await uploadBytes(storageRef,file);

const imageUrl=await getDownloadURL(storageRef);

await addDoc(collection(db,"products"),{
name:name.value,
price:price.value,
category:category.value,
image:imageUrl,
createdAt:Date.now()
});

alert("Product Added âœ…");

showAdd();
};

/* ===== Load Products ===== */

window.loadProducts=async()=>{

const snap=await getDocs(collection(db,"products"));

let html="<h2>Products</h2>";

snap.forEach(docu=>{
const p=docu.data();

html+=`
<div class="product-box">
<img src="${p.image}">
<div>
<div>${p.name}</div>
<div>${p.price} $</div>
<div>${p.category}</div>
</div>

<button class="delete-btn" onclick="deleteProduct('${docu.id}')">
Delete
</button>

</div>
`;
});

content.innerHTML=html;
};

/* ===== Delete Product ===== */

window.deleteProduct=async(id)=>{
await deleteDoc(doc(db,"products",id));
loadProducts();
};

window.logout=()=>{
signOut(auth);
};

</script>

</body>
</html>
