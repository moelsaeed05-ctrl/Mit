<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MIT STORE</title>

<style>

*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:Arial;
}

body{
background:black;
color:white;
overflow:hidden;
}

/* Profile */

.profile{
position:absolute;
top:20px;
left:20px;
width:55px;
height:55px;
border-radius:50%;
overflow:hidden;
border:2px solid #ffd700;
cursor:pointer;
}

.profile img{
width:100%;
height:100%;
object-fit:cover;
}

/* Logo */

.logo{
position:absolute;
top:25px;
left:50%;
transform:translateX(-50%);
font-size:36px;
letter-spacing:6px;
}

/* Menu */

.menu{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
display:flex;
flex-direction:column;
gap:40px;
}

.item{
cursor:pointer;
font-size:22px;
transition:.3s;
}

.item:hover{
transform:scale(1.2);
}

/* Popup */

.popup{
position:fixed;
inset:0;
background:rgba(0,0,0,.9);
display:none;
align-items:center;
justify-content:center;
}

.box{
background:#111;
padding:25px;
border-radius:15px;
width:280px;
display:flex;
flex-direction:column;
gap:10px;
}

.box input,.box button{
padding:8px;
border:none;
border-radius:8px;
}

.box button{
background:#ffd700;
cursor:pointer;
font-weight:bold;
}

</style>
</head>

<body>

<div class="profile" onclick="openPopup()">
<img id="profileImg"
src="https://cdn-icons-png.flaticon.com/512/149/149071.png">
</div>

<div class="logo">MIT STORE</div>

<div class="menu">
<div class="item">ðŸ§¥ HOODIES</div>
<div class="item">ðŸ‘– PANTS</div>
<div class="item">âŒš ACCESSORIES</div>
</div>

<div class="popup" id="popup">
<div class="box" id="popupContent"></div>
</div>

<script type="module">

import { initializeApp }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";

import {
getAuth,
createUserWithEmailAndPassword,
signInWithEmailAndPassword,
onAuthStateChanged,
updateProfile,
signOut
}
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

import {
getFirestore,
doc,
setDoc,
getDoc
}
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* Firebase Config */

const firebaseConfig={
apiKey:"AIzaSyA1X_1BlviMDKKUGnA8yfG6NCrfS65h524",
authDomain:"mit-store-bd580.firebaseapp.com",
projectId:"mit-store-bd580",
storageBucket:"mit-store-bd580.firebasestorage.app",
messagingSenderId:"382577223227",
appId:"1:382577223227:web:113177bef81c5afb06de1e"
};

/* Initialize Firebase */

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);

/* Popup System */

window.openPopup=()=>{
if(auth.currentUser) showProfile();
else showMain();

popup.style.display="flex";
};

function showMain(){
popupContent.innerHTML=`
<h3>Account</h3>
<button onclick="showLogin()">Login</button>
<button onclick="showRegister()">Create Account</button>
<button onclick="popup.style.display='none'">Close</button>
`;
}

window.showLogin=()=>{
popupContent.innerHTML=`
<h3>Login</h3>
<input id="loginEmail" placeholder="Email">
<input id="loginPass" type="password" placeholder="Password">
<button onclick="login()">Login</button>
<button onclick="showMain()">Back</button>
`;
};

window.showRegister=()=>{
popupContent.innerHTML=`
<h3>Create Account</h3>
<input id="regName" placeholder="Full Name">
<input id="regPhone" placeholder="Phone">
<input id="regEmail" placeholder="Email">
<input id="regPass" type="password" placeholder="Password">
<button onclick="register()">Create</button>
<button onclick="showMain()">Back</button>
`;
};

/* Register */

window.register=async()=>{

try{

const user=await createUserWithEmailAndPassword(
auth,
regEmail.value,
regPass.value
);

await updateProfile(user.user,{
displayName:regName.value
});

await setDoc(doc(db,"users",user.user.uid),{
name:regName.value,
phone:regPhone.value,
email:regEmail.value
});

alert("Account Created ðŸ”¥");
popup.style.display="none";

}catch(e){
alert(e.message);
}

};

/* Login */

window.login=async()=>{

try{

await signInWithEmailAndPassword(
auth,
loginEmail.value,
loginPass.value
);

popup.style.display="none";

}catch(e){
alert(e.message);
}

};

/* Profile */

async function showProfile(){

const user=auth.currentUser;

const snap=await getDoc(
doc(db,"users",user.uid)
);

popupContent.innerHTML=`
<h3>${snap.data().name}</h3>
<p>${snap.data().email}</p>
<p>${snap.data().phone}</p>

<button onclick="logout()">Logout</button>
<button onclick="popup.style.display='none'">Close</button>
`;
}

/* Logout */

window.logout=()=>{
signOut(auth);
};

/* Auth State */

onAuthStateChanged(auth,(user)=>{
if(user){
profileImg.src=
"https://cdn-icons-png.flaticon.com/512/4140/4140048.png";
}
});

</script>

</body>
</html>
