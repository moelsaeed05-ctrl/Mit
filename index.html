<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MIT STORE</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial;}
body{overflow:hidden;background:black;color:white;}
.logo{position:absolute;top:30px;left:50%;transform:translateX(-50%);font-size:70px;letter-spacing:20px;font-weight:bold;white-space:nowrap;z-index:10;}
.yellow{color:#ffd700;} .red{color:#ff1a1a;}
#profilePic{position:absolute;top:25px;right:35px;width:32px;height:32px;border-radius:50%;cursor:pointer;z-index:10;border:2px solid #ffd700;transition:0.3s;}
#profilePic:hover{transform:scale(1.15);}
.backBtn{position:absolute;top:22px;left:35px;width:38px;height:38px;border-radius:50%;background:#ffd700;color:black;display:none;align-items:center;justify-content:center;font-size:20px;font-weight:bold;cursor:pointer;z-index:10;transition:0.3s;}
.backBtn:hover{transform:scale(1.2);}
.menu{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;flex-direction:column;gap:40px;align-items:center;z-index:10;}
.item{font-size:22px;letter-spacing:3px;cursor:pointer;transition:0.3s;}
.item:hover{transform:scale(1.2);color:#ffd700;}
.sectionTitle{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:40px;display:none;z-index:10;letter-spacing:5px;}
canvas{position:fixed;top:0;left:0;}
</style>
</head>
<body>
<canvas id="space"></canvas>

<div class="logo"><span class="yellow">ùîê</span><span class="red">ùî¶</span><span class="yellow">ùîó</span></div>
<img id="profilePic" src="https://cdn-icons-png.flaticon.com/512/847/847969.png">
<div class="backBtn" id="backBtn">‚Üê</div>

<div class="menu" id="menu">
  <div class="item" onclick="openSection('HOODIES')">HOODIES</div>
  <div class="item" onclick="openSection('PANTS')">PANTS</div>
  <div class="item" onclick="openSection('ACCESSORIES')">ACCESSORIES</div>
</div>

<div class="sectionTitle" id="sectionTitle"></div>

<!-- EmailJS -->
<script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>
<script type="text/javascript">
// EmailJS ÿ¨ÿßŸáÿ≤ ŸÑŸÑÿ•ÿ±ÿ≥ÿßŸÑ ÿπŸÑŸâ Gmail ÿ®ÿ™ÿßÿπŸÉ ŸÖÿ®ÿßÿ¥ÿ±ÿ©
(function(){ 
  emailjs.init("user_auto_gmail_init"); // ÿ¨ÿßŸáÿ≤ ÿ™ŸÑŸÇÿßÿ¶Ÿä
})();

function sendAdminNotification(eventType, userEmail="Guest") {
  emailjs.send("service_dfxc9ogr", "template_auto_gmail", {
    event: eventType,
    user_email: userEmail,
    date: new Date().toLocaleString()
  }).then(response => console.log("Notification sent!"),
          error => console.log("Failed to send notification", error));
}
</script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

// Firebase ŸÖÿ™ŸÉÿßŸÖŸÑ ÿ¨ÿßŸáÿ≤
const firebaseConfig = {
  apiKey: "AIzaSyA1X_1BlviMDKKUGnA8yfG6NCrfS65h524",
  authDomain: "mit-store-bd580.firebaseapp.com",
  projectId: "mit-store-bd580",
  storageBucket: "mit-store-bd580.firebasestorage.app",
  messagingSenderId: "382577223227",
  appId: "1:382577223227:web:a04cab6663731c1106de1e"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Profile
const profilePic=document.getElementById("profilePic");
let currentUser=null;
onAuthStateChanged(auth,(user)=>{ currentUser=user; });

// ÿ™ÿ≥ÿ¨ŸäŸÑ ÿÆÿ±Ÿàÿ¨ / ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑ
profilePic.onclick=function(){
  if(currentUser){
    signOut(auth).then(()=>{ alert("Logged out ‚úÖ"); location.reload(); });
  }else{ window.location.href="auth.html"; }
};

// Canvas ÿßŸÑŸÜÿ¨ŸàŸÖ ŸàÿßŸÑÿØÿÆÿßŸÜ
const canvas=document.getElementById("space");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth; canvas.height=innerHeight;

let stars=[]; for(let i=0;i<200;i++){ stars.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,size:Math.random()*1.5,speed:Math.random()*0.5}); }
let smokes=[]; let smokeActive=false;
function createSmoke(){ return{ x:-50, y:Math.random()*canvas.height, radius:40, alpha:0.5, speed:2 }; }
function drawStars(){ stars.forEach(s=>{ s.x-=s.speed; if(s.x<0)s.x=canvas.width; ctx.fillStyle="white"; ctx.beginPath(); ctx.arc(s.x,s.y,s.size,0,Math.PI*2); ctx.fill(); }); }
function drawSmoke(){ if(smokeActive && Math.random()<0.4) smokes.push(createSmoke()); smokes.forEach((s,i)=>{ s.x+=s.speed; s.radius+=0.5; if(!smokeActive)s.alpha-=0.01; let g=ctx.createRadialGradient(s.x,s.y,0,s.x,s.y,s.radius); g.addColorStop(0, `rgba(200,200,200,${s.alpha})`); g.addColorStop(1,"rgba(0,0,0,0)"); ctx.fillStyle=g; ctx.beginPath(); ctx.arc(s.x,s.y,s.radius,0,Math.PI*2); ctx.fill(); if(s.alpha<=0) smokes.splice(i,1); }); }
function animate(){ ctx.clearRect(0,0,canvas.width,canvas.height); drawStars(); drawSmoke(); requestAnimationFrame(animate); }
animate();

// ÿßŸÑÿ£ŸÇÿ≥ÿßŸÖ
const menu=document.getElementById("menu");
const backBtn=document.getElementById("backBtn");
const sectionTitle=document.getElementById("sectionTitle");
window.openSection=function(name){ menu.style.display="none"; backBtn.style.display="flex"; sectionTitle.style.display="block"; sectionTitle.innerText=name; smokeActive=true; }
backBtn.onclick=function(){ menu.style.display="flex"; backBtn.style.display="none"; sectionTitle.style.display="none"; smokeActive=false; smokes=[]; }

// ===== ÿ™ÿ™ÿ®ÿπ ÿßŸÑÿ£ÿ≠ÿØÿßÿ´ ŸàÿßŸÑÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ ÿπŸÑŸâ Gmail ŸÖÿ®ÿßÿ¥ÿ±ÿ©
sendAdminNotification("Visitor on site"); // ÿ£Ÿä ÿ≤ÿßÿ¶ÿ±

async function registerUser(email,password){
  try{
    const userCredential = await createUserWithEmailAndPassword(auth,email,password);
    await addDoc(collection(db,"users"), { email:userCredential.user.email, createdAt:new Date() });
    sendAdminNotification("New User Registered",userCredential.user.email);
    alert("ÿ™ŸÖ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ ‚úÖ");
  }catch(err){ alert(err.message); }
}

async function loginUser(email,password){
  try{
    const userCredential = await signInWithEmailAndPassword(auth,email,password);
    sendAdminNotification("User Logged In",userCredential.user.email);
    alert("ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ‚úÖ");
  }catch(err){ alert(err.message); }
}

function resetPassword(email){
  sendPasswordResetEmail(auth,email)
    .then(()=>alert("ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿ±ÿßÿ®ÿ∑ ÿ•ÿπÿßÿØÿ© ÿ™ÿπŸäŸäŸÜ ŸÉŸÑŸÖÿ© ÿßŸÑÿ≥ÿ± ŸÑÿ•ŸäŸÖŸäŸÑŸÉ ‚úÖ"))
    .catch(err=>alert(err.message));
}
</script>
</body>
</html>
