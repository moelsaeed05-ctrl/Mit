<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MIT STORE</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial;}
body{background:black;color:white;overflow:hidden;}
#space{position:fixed;inset:0;z-index:0;pointer-events:none;}

.logo{
position:absolute;
top:20px;
left:50%;
transform:translateX(-50%);
font-size:28px;
letter-spacing:6px;
z-index:10;
}

.userMenu{
position:absolute;
top:20px;
right:20px;
z-index:20;
}

.loginBtn{
background:#ffd700;
color:black;
padding:6px 14px;
border-radius:8px;
cursor:pointer;
font-weight:bold;
font-size:14px;
}

.dropdown{
display:none;
flex-direction:column;
background:#111;
margin-top:5px;
border-radius:10px;
overflow:hidden;
box-shadow:0 0 10px #ffd700;
}

.dropdown div{
padding:10px;
cursor:pointer;
border-bottom:1px solid #222;
}
.dropdown div:hover{
background:#222;
}

.menu{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
display:flex;
flex-direction:column;
gap:35px;
z-index:10;
width:80%;
align-items:center;
}

.item{
cursor:pointer;
font-size:22px;
padding:12px 30px;
border-radius:12px;
transition:.4s;
}
.item:hover{text-shadow:0 0 10px #ffd700;}

.fullscreen{
position:fixed;
inset:0;
background:black;
display:none;
flex-direction:column;
align-items:center;
z-index:40;
padding-top:90px;
overflow:auto;
}

.categoryTitle{
font-size:28px;
margin-bottom:20px;
letter-spacing:3px;
animation:neonGlow 1.5s ease-in-out;
}
@keyframes neonGlow{
0%{text-shadow:0 0 5px #ffd700;}
50%{text-shadow:0 0 20px #ffd700,0 0 40px #ffd700;}
100%{text-shadow:0 0 5px #ffd700;}
}

.products{
display:flex;
gap:20px;
flex-wrap:wrap;
justify-content:center;
width:95%;
}

.product{
background:#111;
padding:12px;
border-radius:14px;
width:160px;
transition:.4s;
}
.product img{
width:100%;
border-radius:8px;
margin-bottom:8px;
}
.product:hover{
transform:scale(1.08);
box-shadow:0 0 10px #ffd700;
}

button{
padding:8px;
border:none;
border-radius:8px;
background:#ffd700;
cursor:pointer;
width:100%;
margin-top:5px;
}

.modal{
position:fixed;
inset:0;
background:rgba(0,0,0,.9);
display:none;
justify-content:center;
align-items:center;
z-index:100;
}

.modalBox{
background:#111;
padding:25px;
border-radius:18px;
width:320px;
max-height:80vh;
overflow:auto;
}

input{
width:100%;
padding:10px;
margin:8px 0;
border:none;
border-radius:6px;
background:#222;
color:white;
}

/* ===== Smoke Canvas ===== */
.smokeCanvas{
position:absolute;
inset:0;
z-index:30;
pointer-events:none;
}
</style>
</head>
<body>

<canvas id="space"></canvas>

<div class="logo">MIT</div>

<div class="userMenu">
<div class="loginBtn" id="loginBtn" onclick="toggleMenu()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
<div class="dropdown" id="dropdown">
<div onclick="openCart()">ğŸ›’ Ø§Ù„Ø³Ù„Ø©</div>
<div onclick="openOrders()">ğŸ“¦ Ù…Ø´ØªØ±ÙŠØ§ØªÙŠ</div>
<div onclick="logout()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</div>
</div>
</div>

<div class="menu">
<div class="item" onclick="openCategory('HOODIES')">HOODIES</div>
<div class="item" onclick="openCategory('PANTS')">PANTS</div>
<div class="item" onclick="openCategory('ACCESSORIES')">ACCESSORIES</div>
</div>

<div class="fullscreen" id="page">
<canvas class="smokeCanvas" id="smoke"></canvas>
<div class="categoryTitle" id="categoryTitle"></div>
<div class="products" id="products"></div>
</div>

<div class="modal" id="loginModal">
<div class="modalBox">
<h3>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</h3>
<input type="email" id="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯">
<input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
<button onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
<hr style="margin:10px 0">
<h3>Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</h3>
<input type="text" id="name" placeholder="Ø§Ù„Ø§Ø³Ù…">
<input type="email" id="regEmail" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯">
<input type="password" id="regPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
<button onclick="register()">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
</div>
</div>

<div class="modal" id="cartModal">
<div class="modalBox" id="cartBox"></div>
</div>

<div class="modal" id="ordersModal">
<div class="modalBox" id="ordersBox"></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth,createUserWithEmailAndPassword,signInWithEmailAndPassword,onAuthStateChanged,signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore,doc,setDoc,getDoc,updateDoc,arrayUnion } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig={
apiKey:"YOUR_KEY",
authDomain:"YOUR_DOMAIN",
projectId:"YOUR_ID"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);

let currentUser=null;
let cart=[];

const loginBtn=document.getElementById("loginBtn");
const dropdown=document.getElementById("dropdown");
const loginModal=document.getElementById("loginModal");
const page=document.getElementById("page");
const categoryTitle=document.getElementById("categoryTitle");
const products=document.getElementById("products");
const smokeCanvas=document.getElementById("smoke");
const smokeCtx=smokeCanvas.getContext("2d");

onAuthStateChanged(auth,async(user)=>{
if(user){
currentUser=user;
const snap=await getDoc(doc(db,"users",user.uid));
loginBtn.innerText=snap.data().name;
dropdown.style.display="flex";
}else{
loginBtn.innerText="ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„";
dropdown.style.display="none";
}
});

window.toggleMenu=()=>{
if(!currentUser){loginModal.style.display="flex";}
else dropdown.style.display=dropdown.style.display==="flex"?"none":"flex";
}

window.register=async()=>{
try{
const user=await createUserWithEmailAndPassword(auth,regEmail.value,regPass.value);
await setDoc(doc(db,"users",user.user.uid),{name:name.value,cart:[],orders:[]});
alert("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨");
loginModal.style.display="none";
}catch(e){alert(e.message);}
}

window.login=async()=>{
try{
await signInWithEmailAndPassword(auth,email.value,pass.value);
loginModal.style.display="none";
}catch(e){alert(e.message);}
}

window.logout=()=>signOut(auth);

window.openCategory=(cat)=>{
page.style.display="flex";
categoryTitle.innerText=cat;
products.innerHTML="";
startSmoke(); // Ø´ØºÙ„ Ø§Ù„Ø¯Ø®Ø§Ù†
data[cat].forEach(p=>{
products.innerHTML+=`
<div class="product">
<img src="${p.img}">
<div>${p.name}</div>
<div style="color:#ffd700">${p.price}</div>
<button onclick='addToCart(${JSON.stringify(p)})'>Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</button>
</div>`;
});
}

window.addToCart=(p)=>{
cart.push(p);
alert("ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©");
}

window.openCart=()=>{
cartModal.style.display="flex";
cartBox.innerHTML="<h3>Ø§Ù„Ø³Ù„Ø©</h3>";
cart.forEach(p=>{
cartBox.innerHTML+=`<div>${p.name} - ${p.price}</div>`;
});
cartBox.innerHTML+=`<button onclick="checkout()">Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø´Ø±Ø§Ø¡</button>`;
}

window.checkout=async()=>{
if(!currentUser){alert("Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§");return;}
await updateDoc(doc(db,"users",currentUser.uid),{
orders:arrayUnion(...cart)
});
cart=[];
cartModal.style.display="none";
alert("ØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡");
}

window.openOrders=async()=>{
if(!currentUser){alert("Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§");return;}
ordersModal.style.display="flex";
const snap=await getDoc(doc(db,"users",currentUser.uid));
ordersBox.innerHTML="<h3>Ù…Ø´ØªØ±ÙŠØ§ØªÙŠ</h3>";
snap.data().orders.forEach(o=>{
ordersBox.innerHTML+=`<div>${o.name} - ${o.price}</div>`;
});
}

// ===== Stars Background =====
const canvas=document.getElementById("space");
const ctx=canvas.getContext("2d");
canvas.width=innerWidth;
canvas.height=innerHeight;
let stars=[];
for(let i=0;i<250;i++){stars.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,s:Math.random()*0.5+0.2});}
function animateStars(){
ctx.clearRect(0,0,canvas.width,canvas.height);
stars.forEach(st=>{
st.x-=st.s;
if(st.x<0)st.x=canvas.width;
ctx.fillStyle="white";
ctx.fillRect(st.x,st.y,1.5,1.5);
});
requestAnimationFrame(animateStars);
}
animateStars();

// ===== Smoke when section open =====
smokeCanvas.width=innerWidth;
smokeCanvas.height=innerHeight;
let smokes=[];
let smokeInterval=null;
function createSmoke(){return{x:Math.random()*innerWidth,y:Math.random()*innerHeight,r:Math.random()*120+50,a:0.3};}
function animateSmoke(){
smokeCtx.clearRect(0,0,innerWidth,innerHeight);
smokes.forEach((s,i)=>{
s.a-=0.002;
let g=smokeCtx.createRadialGradient(s.x,s.y,0,s.x,s.y,s.r);
g.addColorStop(0,`rgba(200,200,200,${s.a})`);
g.addColorStop(1,"transparent");
smokeCtx.fillStyle=g;
smokeCtx.beginPath();
smokeCtx.arc(s.x,s.y,s.r,0,Math.PI*2);
smokeCtx.fill();
if(s.a<=0)smokes.splice(i,1);
});
requestAnimationFrame(animateSmoke);
}
function startSmoke(){
smokes=[];
smokeCanvas.style.display="block";
clearInterval(smokeInterval);
smokeInterval=setInterval(()=>{if(Math.random()<0.3)smokes.push(createSmoke());},50);
animateSmoke();
setTimeout(()=>{smokeCanvas.style.display="none";clearInterval(smokeInterval);},10000);
}

// ===== Products Data =====
const data={
HOODIES:[
{name:"Black Hoodie",img:"https://picsum.photos/200?1",price:"50$"},
{name:"Gray Hoodie",img:"https://picsum.photos/200?2",price:"55$"},
{name:"Red Hoodie",img:"https://picsum.photos/200?3",price:"60$"},
{name:"White Hoodie",img:"https://picsum.photos/200?4",price:"65$"},
{name:"Blue Hoodie",img:"https://picsum.photos/200?5",price:"70$"}
],
PANTS:[
{name:"Black Pants",img:"https://picsum.photos/200?6",price:"40$"},
{name:"Jogger",img:"https://picsum.photos/200?7",price:"45$"},
{name:"Cargo",img:"https://picsum.photos/200?8",price:"50$"},
{name:"Slim Fit",img:"https://picsum.photos/200?9",price:"55$"},
{name:"Classic",img:"https://picsum.photos/200?10",price:"60$"}
],
ACCESSORIES:[
{name:"Cap",img:"https://picsum.photos/200?11",price:"20$"},
{name:"Bag",img:"https://picsum.photos/200?12",price:"25$"},
{name:"Watch",img:"https://picsum.photos/200?13",price:"80$"},
{name:"Chain",img:"https://picsum.photos/200?14",price:"30$"},
{name:"Bracelet",img:"https://picsum.photos/200?15",price:"15$"}
]
};
</script>
</body>
</html>
