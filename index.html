<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>MIT STORE</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial}
body{background:black;color:white;overflow-x:hidden}
canvas{position:fixed;top:0;left:0;z-index:-1}

.logo{text-align:center;margin-top:20px;font-size:35px;letter-spacing:6px}
.yellow{color:#ffd700}
.red{color:#ff1a1a}

.menu{
display:flex;
justify-content:center;
gap:40px;
margin-top:80px;
}

.item{
cursor:pointer;
font-size:20px;
padding:10px 25px;
border-radius:12px;
transition:.3s;
}

.item:hover{
color:#ffd700;
box-shadow:0 0 10px #ffd700,0 0 25px #ffd700;
transform:scale(1.1);
}

#products{
display:flex;
flex-wrap:wrap;
justify-content:center;
gap:20px;
margin-top:40px;
}

.card{
background:#111;
padding:15px;
width:200px;
border-radius:15px;
text-align:center;
}

.card img{
width:100%;
height:160px;
object-fit:cover;
border-radius:10px;
}

button{
padding:8px;
border:none;
border-radius:8px;
cursor:pointer;
background:#ffd700;
margin-top:5px;
}

.adminPanel,.cartPanel{
position:fixed;
right:0;
top:0;
width:320px;
height:100%;
background:#111;
padding:20px;
overflow:auto;
display:none;
}

input,select{
width:100%;
padding:8px;
margin:5px 0;
border-radius:8px;
border:none;
}
</style>
</head>
<body>

<div class="logo">
<span class="yellow">ùîê</span>
<span class="red">ùî¶</span>
<span class="yellow">ùîó</span>
</div>

<div class="menu">
<div class="item" onclick="loadProducts('HOODIES')">HOODIES</div>
<div class="item" onclick="loadProducts('PANTS')">PANTS</div>
<div class="item" onclick="loadProducts('ACCESSORIES')">ACCESSORIES</div>
<div class="item" onclick="toggleCart()">CART</div>
</div>

<div id="products"></div>

<!-- ADMIN -->
<div class="adminPanel" id="adminPanel">
<h3>Admin Panel</h3>

<input id="pName" placeholder="Product Name">
<input id="pPrice" placeholder="Price">
<select id="pCategory">
<option>HOODIES</option>
<option>PANTS</option>
<option>ACCESSORIES</option>
</select>
<input type="file" id="pImage">
<button onclick="addProduct()">Add Product</button>

<hr>

<h4>Statistics</h4>
<p id="stats"></p>

<button onclick="adminPanel.style.display='none'">Close</button>
</div>

<!-- CART -->
<div class="cartPanel" id="cartPanel">
<h3>Your Cart</h3>
<div id="cartItems"></div>
<button onclick="checkout()">Checkout</button>
<button onclick="cartPanel.style.display='none'">Close</button>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getAuth, signInWithEmailAndPassword,
onAuthStateChanged }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

import { getFirestore, collection, addDoc,
getDocs, doc, setDoc }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

import { getStorage, ref, uploadBytes, getDownloadURL }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

const firebaseConfig={
apiKey:"AIzaSyA1X_1BlviMDKKUGnA8yfG6NCrfS65h524",
authDomain:"mit-store-bd580.firebaseapp.com",
projectId:"mit-store-bd580",
storageBucket:"mit-store-bd580.appspot.com",
messagingSenderId:"382577223227",
appId:"1:382577223227:web:113177bef81c5afb06de1e"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);
const storage=getStorage(app);

const ADMIN_EMAIL="timofisha@gmail.com";
const ADMIN_PASS="kingtemo11";

let currentUser=null;
let cart=[];

/* ===== AUTO ADMIN LOGIN ===== */
signInWithEmailAndPassword(auth,ADMIN_EMAIL,ADMIN_PASS)
.catch(()=>{});

onAuthStateChanged(auth,user=>{
if(user){
currentUser=user;

if(user.email===ADMIN_EMAIL){
adminPanel.style.display="block";
loadStats();
}
}
});

/* ===== PRODUCTS ===== */
window.loadProducts=async(cat)=>{
products.innerHTML="";
const snap=await getDocs(collection(db,"products"));

snap.forEach(docSnap=>{
const d=docSnap.data();
if(d.category===cat){
products.innerHTML+=`
<div class="card">
<img src="${d.image}">
<h4>${d.name}</h4>
<p>$${d.price}</p>
<button onclick='addToCart(${JSON.stringify(d)})'>Add To Cart</button>
</div>
`;
}
});
};

/* ===== ADD PRODUCT (ADMIN) ===== */
window.addProduct=async()=>{
const file=pImage.files[0];
const storageRef=ref(storage,"products/"+file.name);
await uploadBytes(storageRef,file);
const url=await getDownloadURL(storageRef);

await addDoc(collection(db,"products"),{
name:pName.value,
price:pPrice.value,
category:pCategory.value,
image:url
});

alert("Product Added üî•");
loadStats();
};

/* ===== CART ===== */
window.addToCart=(product)=>{
cart.push(product);
updateCart();
};

function updateCart(){
cartItems.innerHTML="";
cart.forEach((p,i)=>{
cartItems.innerHTML+=`
<p>${p.name} - $${p.price}</p>
`;
});
}

window.toggleCart=()=>{
cartPanel.style.display="block";
};

window.checkout=async()=>{
await setDoc(doc(db,"orders",currentUser.uid),{
items:cart,
total:cart.reduce((a,b)=>a+Number(b.price),0)
});
alert("Order Placed üî•");
cart=[];
updateCart();
};

/* ===== STATS ===== */
async function loadStats(){
const productsSnap=await getDocs(collection(db,"products"));
const ordersSnap=await getDocs(collection(db,"orders"));
const usersSnap=await getDocs(collection(db,"users"));

stats.innerHTML=`
Products: ${productsSnap.size}<br>
Orders: ${ordersSnap.size}<br>
Users: ${usersSnap.size}
`;
}

</script>
</body>
</html>
